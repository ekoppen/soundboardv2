<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles/style.css?v=5.9">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mina" />
    <meta name="viewport" content="width=device-width, 
    minimum-scale=1.0, maximum-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.5.0.js"></script>
    <script src="/js/isotope.pkgd.js"></script>
    <script src="/js/storage-helper.js"></script>
    <script src="/js/groups-helper.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>

    <script src="socket.io/socket.io.js"></script>
    <script src="https://kit.fontawesome.com/4191eec88b.js" crossorigin="anonymous"></script>
    <title>Soundboard</title>
</head>

<body>
    <nav>
        <div class="topnav" id="myTopnav">
            <a href="/" class="active menu">Home</a>
            <a href="/studio" class="menu">Studio</a>

            <div class="nav-controls">
                <input type="text" class="quicksearch" placeholder="zoek op naam of tag" />
                <button id="add-group-btn" class="nav-icon-btn" title="Nieuwe Groep">
                    <i class="fas fa-plus"></i>
                </button>
                <button id="show-hidden-toggle" class="nav-icon-btn" title="Toggle Hidden Sounds">
                    <i class="fa-regular fa-eye-slash"></i>
                </button>
                <button id="discord-toggle" class="nav-icon-btn" title="Toggle Discord Integration">
                    <i class="fab fa-discord"></i>
                </button>
            </div>

            <div class="logged-in-user"></div>
            <div class="online-counter">
                <i class="fas fa-users"></i>
                <span class="counter-text"></span>
            </div>
            <div class="selector-menu">
                <div id="filters" class="button-group filters-button-group sort">
                </div>
            </div>
        </div>
    </nav>


    <div class="main">
        <div class="bgboem"><img src="/img/boem.png" alt=""></div>

        <!-- Toast Notification Container -->
        <div class="toast-container" id="toast-container"></div>

        <!-- Sound Groups Section -->
        <div class="groups-section" id="groups-section">
            <div class="groups-container" id="groups-container">
                <!-- Groups will be dynamically added here -->
            </div>
        </div>

        <!-- Welcome Modal -->
        <div class="modal-overlay" id="welcome-modal-overlay">
            <div class="welcome-modal">
                <div class="modal-header">
                    <h2>Welkom bij de Soundboard! üéµ</h2>
                    <p>Ontdek de nieuwe functies</p>
                </div>
                <div class="modal-body">
                    <ul class="feature-list">
                        <li class="feature-item">
                            <div class="feature-icon">üîî</div>
                            <div class="feature-content">
                                <h3>Toast Notificaties</h3>
                                <p>Ontvang vriendelijke meldingen voor je acties zonder het scherm te blokkeren</p>
                            </div>
                        </li>
                        <li class="feature-item">
                            <div class="feature-icon">‚≠ê</div>
                            <div class="feature-content">
                                <h3>Favorieten</h3>
                                <p>Markeer je favoriete sounds met een ster voor snelle toegang</p>
                            </div>
                        </li>
                        <li class="feature-item">
                            <div class="feature-icon">üëÅÔ∏è</div>
                            <div class="feature-content">
                                <h3>Verberg Sounds</h3>
                                <p>Verberg sounds die je tijdelijk niet wilt zien, schakel ze gemakkelijk aan/uit</p>
                            </div>
                        </li>
                        <li class="feature-item">
                            <div class="feature-icon">üîó</div>
                            <div class="feature-content">
                                <h3>Deel Functie</h3>
                                <p>Kopieer een directe link naar een sound om te delen met anderen</p>
                            </div>
                        </li>
                        <li class="feature-item">
                            <div class="feature-icon">üéÆ</div>
                            <div class="feature-content">
                                <h3>Discord Integratie</h3>
                                <p>Speel sounds af in Discord voice channels met √©√©n klik</p>
                            </div>
                        </li>
                        <li class="feature-item">
                            <div class="feature-icon">üîÑ</div>
                            <div class="feature-content">
                                <h3>Drag & Drop Sortering</h3>
                                <p>Versleep sounds om ze op volgorde te zetten. Je volgorde wordt automatisch opgeslagen</p>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" id="welcome-modal-close">Begrepen, laten we gaan! üöÄ</button>
                </div>
            </div>
        </div>

        <div class="container-grid">
        </div>

    </div>
    </div>
    
    <% sounditems.forEach(function(sounditem) { %>
        <section>
            <audio class="<%= sounditem.class %>"
                title="<%= sounditem.title %>"
                play_count="<%= sounditem.play_count %>"
                id="<%= sounditem._id %>"
                search_tags="<%= sounditem.search_tags %>"
                date_created="<%= sounditem.created_at %>"
                sound_length="<%= sounditem.sound_length %>"
                soundImage="<%= sounditem.soundImage %>"
                waveform_data="<%= sounditem.waveform_data || '[]' %>" >

                <source src="/uploads/sounds/<%= sounditem.audio_file %>" />
            </audio>
        </section>
        <% }); %>


    


        <script>
    
            $(function () {
                var socket = io();
                socket.on("inhoud", function (data) {
                    //console.log(data.counter);
                    //$("ul#doc li#" + data.id + " .playCount").text("#: " + data.counter).animate({ "font-size": "1.5rem" }, 100).animate({ "font-size": "1rem" }, 200);
                    $(".card#" + data.id + " .sound-count").text("#: " + data.counter).animate({ "font-size": "2.0rem" }, 100).animate({ "font-size": "0.9rem" }, 200);
                });
                socket.on("users", function (userCounter) {
                    //console.log(userCounter);
                    $(".online-counter .counter-text").text(userCounter + " online");
                });
                socket.on("message", function (data) {
                    //console.log(data);
                    $('.message-title').text(
                        data.type )
                    $('.message-content').text(
                        data.bericht )

                    $('.message-box').animate({
                        top: '0px'
                    }).delay(data.duration).animate({
                        top: '-110px'
                    });
                })
        
            });

        
            $('')
            function linksAan(dataIn, dataDuration) {
                $.post("/update", { "id": dataIn });
                 $(".card#" + dataIn + " .progress").delay(2000).css(
                       "left",
                       "-350px");
                    $(".card#" + dataIn + " .duration-counter").css("visibility", "hidden");
                    $(".card#" + dataIn + " .sound-timer").css("visibility","visible");
            }
        

        </script>
        <script src="js/script.js?v=1.4"></script>

    
        <script>
            $(document).ready(function () {
                
                var buttonFilters = {};
                var buttonFilter;
                // quick search regex
                var qsRegex;
    
                // init Isotope
                var $grid = $('.container-grid').isotope({
                    itemSelector: '.card',
                    filter: function () {
                        var $this = $(this);
                        var searchResult = qsRegex ? $this.text().match(qsRegex) : true;
                        var buttonResult = buttonFilter ? $this.is(buttonFilter) : true;
                        return searchResult && buttonResult;
                    },
                    masonry: {
                        fitWidth: true
                        }
                });

    
    
                
    
                // use value of search field to filter
                var $quicksearch = $('.quicksearch').keyup(debounce(function () {
                    qsRegex = new RegExp($quicksearch.val(), 'gi');
                    $grid.isotope();
                }));
    
    

    
                // flatten object by concatting values
                function concatValues(obj) {
                    var value = '';
                    for (var prop in obj) {
                        value += obj[prop];
                    }
                    return value;
                }
    
    
                // debounce so filtering doesn't happen every millisecond
                function debounce(fn, threshold) {
                    var timeout;
                    threshold = threshold || 100;
                    return function debounced() {
                        clearTimeout(timeout);
                        var args = arguments;
                        var _this = this;
                        function delayed() {
                            fn.apply(_this, args);
                        }
                        timeout = setTimeout(delayed, threshold);
                    };
                }
    
                    function checkResponses(){
                        var sections = $("section").length
                        if  (sections >= 2) {
                            console.log("meerdere")
                        }
                        else {
                        $("audio").get(0).play()
                        console.log("enkel")
                        }
                    }
                    checkResponses()
    
            })
            

        </script>
    <input type="text" class="hibbem"></input>    
       
    </body>
    